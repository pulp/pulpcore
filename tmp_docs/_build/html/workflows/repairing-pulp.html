<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Repairing Pulp &mdash; Pulp Project 3.23.0.dev documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Reclaim disk space for a list of repositories" href="reclaim-disk-space.html" />
    <link rel="prev" title="Metadata Signing" href="signed-metadata.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Pulp Project
          </a>
              <div class="version">
                3.23.0.dev
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../concepts.html">Concepts and Terminology</a></li>
<li class="toctree-l1"><a class="reference internal" href="../from-pulp-2.html">Changes From Pulp 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installation Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authentication/index.html">Authentication</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Workflows and Use Cases</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="alternate-content-sources.html">Alternate Content Sources</a></li>
<li class="toctree-l2"><a class="reference internal" href="upload-publish.html">Upload and Publish</a></li>
<li class="toctree-l2"><a class="reference internal" href="repo-versioning.html">Repository Versioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="on-demand-downloading.html">On-Demand Downloading</a></li>
<li class="toctree-l2"><a class="reference internal" href="promotion.html">Promotion</a></li>
<li class="toctree-l2"><a class="reference internal" href="scheduling-tasks.html">Scheduling Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="exposing-content.html">Exposing Content</a></li>
<li class="toctree-l2"><a class="reference internal" href="signed-metadata.html">Metadata Signing</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Repairing Pulp</a></li>
<li class="toctree-l2"><a class="reference internal" href="reclaim-disk-space.html">Reclaim disk space for a list of repositories</a></li>
<li class="toctree-l2"><a class="reference internal" href="import-export.html">Pulp Import and Export</a></li>
<li class="toctree-l2"><a class="reference internal" href="labels.html">Labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin-removal.html">Plugin removal</a></li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugin_dev/index.html">Plugin Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rest_api.html">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client_bindings.html">Client Bindings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bugs-features.html">Bugs, Feature and Backport Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changes.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versioning.html">Versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_process.html">Pulpcore Release Process</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Pulp Project</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Workflows and Use Cases</a></li>
      <li class="breadcrumb-item active">Repairing Pulp</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/workflows/repairing-pulp.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="repairing-pulp">
<span id="id1"></span><h1>Repairing Pulp<a class="headerlink" href="#repairing-pulp" title="Permalink to this heading">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Pulp self-repair features are in tech-preview and may change in backwards incompatible
ways in future releases.</p>
</div>
<p>Pulp provides some features for self-repair in cases where artifacts in the storage went missing or
got corrupted in some way (i.e. bit rot).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This repair feature looks for missing or corrupted files that are supposed to be in
the storage. It attempts a redownload of these files from known upstream urls.
In case upstream stopped serving the corresponding files, or these files were uploaded
directly into Pulp or were created by Pulp itself (i.e. generated metadata), the Pulp
repair feature is unable to remedy the situation.</p>
</div>
<p>To start a repair task for all of Pulp (i.e. checks all content), send a POST request to
<cite>/pulp/api/v3/repair/</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ REPAIR_TASK=$(http POST :24817/pulp/api/v3/repair/ | jq -r &#39;.task&#39;)
$ http --body :24817$REPAIR_TASK

{
    &quot;child_tasks&quot;: [],
    &quot;created_resources&quot;: [],
    &quot;error&quot;: null,
    &quot;finished_at&quot;: &quot;2020-04-07T08:36:52.373633Z&quot;,
    &quot;name&quot;: &quot;pulpcore.app.tasks.repository.repair_all_artifacts&quot;,
    &quot;parent_task&quot;: null,
    &quot;progress_reports&quot;: [
        {
            &quot;code&quot;: &quot;repair.repaired&quot;,
            &quot;done&quot;: 2,
            &quot;message&quot;: &quot;Repair corrupted units&quot;,
            &quot;state&quot;: &quot;completed&quot;,
            &quot;suffix&quot;: null,
            &quot;total&quot;: null
        },
        {
            &quot;code&quot;: &quot;repair.corrupted&quot;,
            &quot;done&quot;: 2,
            &quot;message&quot;: &quot;Identify corrupted units&quot;,
            &quot;state&quot;: &quot;completed&quot;,
            &quot;suffix&quot;: null,
            &quot;total&quot;: null
        }
    ],
    &quot;pulp_created&quot;: &quot;2020-04-07T08:36:52.274985Z&quot;,
    &quot;pulp_href&quot;: &quot;/pulp/api/v3/tasks/530302b4-8674-4db3-8a13-99febef80830/&quot;,
    &quot;reserved_resources_record&quot;: [],
    &quot;started_at&quot;: &quot;2020-04-07T08:36:52.348381Z&quot;,
    &quot;state&quot;: &quot;completed&quot;,
    &quot;task_group&quot;: null,
    &quot;worker&quot;: &quot;/pulp/api/v3/workers/f2fe2811-74a1-463f-93d2-53c7b302115c/&quot;
}
</pre></div>
</div>
<p>To start a repair task on a specific repository version, send a POST request to its <cite>repair</cite>
endpoint:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ REPAIR_TASK=$(http POST :24817${REPOSITORY_VERSION}repair/ | jq -r &#39;.task&#39;)
$ http --body :24817$REPAIR_TASK

{
    &quot;child_tasks&quot;: [],
    &quot;created_resources&quot;: [],
    &quot;error&quot;: null,
    &quot;finished_at&quot;: &quot;2020-04-07T08:36:52.373633Z&quot;,
    &quot;name&quot;: &quot;pulpcore.app.tasks.repository.repair_version&quot;,
    &quot;parent_task&quot;: null,
    &quot;progress_reports&quot;: [
        {
            &quot;code&quot;: &quot;repair.repaired&quot;,
            &quot;done&quot;: 2,
            &quot;message&quot;: &quot;Repair corrupted units&quot;,
            &quot;state&quot;: &quot;completed&quot;,
            &quot;suffix&quot;: null,
            &quot;total&quot;: null
        },
        {
            &quot;code&quot;: &quot;repair.corrupted&quot;,
            &quot;done&quot;: 2,
            &quot;message&quot;: &quot;Identify corrupted units&quot;,
            &quot;state&quot;: &quot;completed&quot;,
            &quot;suffix&quot;: null,
            &quot;total&quot;: null
        }
    ],
    &quot;pulp_created&quot;: &quot;2020-04-07T08:36:52.274985Z&quot;,
    &quot;pulp_href&quot;: &quot;/pulp/api/v3/tasks/530302b4-8674-4db3-8a13-99febef80830/&quot;,
    &quot;reserved_resources_record&quot;: [
        &quot;/pulp/api/v3/repositories/file/file/47a3f651-aaa6-4026-b649-130c45ab38ea/&quot;
    ],
    &quot;started_at&quot;: &quot;2020-04-07T08:36:52.348381Z&quot;,
    &quot;state&quot;: &quot;completed&quot;,
    &quot;task_group&quot;: null,
    &quot;worker&quot;: &quot;/pulp/api/v3/workers/f2fe2811-74a1-463f-93d2-53c7b302115c/&quot;
}
</pre></div>
</div>
<p>The result of this task can be read in the <cite>progress_report</cite> section.
If the number of <cite>done</cite> differs between the reports, pulp was unable to repair all artifacts.</p>
<p>For both endpoints, there is a POST parameter named <code class="docutils literal notranslate"><span class="pre">verify_checksums</span></code>, which defaults to
True. Specifying False when calling one of the repair endpoints will skip the checksum
verification and only check for files which are missing, which is substantially faster and
less resource intensive. However, this won’t detect corrupted files.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="signed-metadata.html" class="btn btn-neutral float-left" title="Metadata Signing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="reclaim-disk-space.html" class="btn btn-neutral float-right" title="Reclaim disk space for a list of repositories" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2012-2023, Pulp Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-74748547-2', 'auto');
  ga('send', 'pageview');

</script>


<script>
$( document ).ready( function() {

  // gets version number minus whitespace and bugfix version
  var $version_number = $('.version').text().trim().split('.', 2).join('.')

  // div mirroring the admonition-warning generated by sphinx if added to .rst
  var warning = '\
          <div class="admonition warning"> \
              <p class="first admonition-title">Warning</p> \
              <p class="last">You are looking at the docs for an unsupported version of Pulp. \
               Consider switching to a  \
               <a href="https://pulpproject.org/docs/">supported version</a></p> \
          </div>'

  
  // get JSON from server and load supported_versions
  $.getJSON("https://raw.githubusercontent.com/pulp/pulp-ci/master/ci/config/releases/supported-releases.json" , function(data) {
    if ($.inArray($version_number, data) === -1) {
      $('.rst-content').prepend(warning)
      }
    })
  })
  </script>


</body>
</html>