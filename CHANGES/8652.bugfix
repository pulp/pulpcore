Backported a fix for on-demand sync/migration of repositories that don't have sha256 checksums.
