Added flags ``immediate`` and ``deferred`` to ``dispatch`` to allow specifying whether a task can
be attempted to run synchronously and whether it can be deferred.
