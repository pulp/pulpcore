Refactored ``cast`` to use a class provided lookup table.
