from rest_framework.mixins import DestroyModelMixin, ListModelMixin, RetrieveModelMixin

from pulpcore.app.models.vulnerability_report import VulnerabilityReport
from pulpcore.app.serializers.vulnerability_report import VulnerabilityReportSerializer
from pulpcore.app.viewsets.base import NamedModelViewSet


class VulnerabilityReportViewSet(
    NamedModelViewSet, ListModelMixin, RetrieveModelMixin, DestroyModelMixin
):

    endpoint_name = "vuln_report"
    queryset = VulnerabilityReport.objects.prefetch_related("repo_versions").select_related(
        "content"
    )
    serializer_class = VulnerabilityReportSerializer

    @classmethod
    def routable(cls):
        return True
